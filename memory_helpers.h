#pragma once
#include <mach/mach.h>

vm_size_t task_read(task_t task, vm_address_t addr, vm_size_t size, void *buf);
vm_size_t task_write(task_t task, vm_address_t addr, vm_size_t size, void *buf);

#define KREAD(t, var, addr) \
do \
{ \
    if(task_read(t, (addr), sizeof(var), &var) != sizeof(var)) \
    { \
        printf("Failed to read %s from 0x%016llx", #var, (addr)); \
        return 1; \
    } \
} while(0)
#define KWRITE(t, var, addr) \
do \
{ \
    if(task_write(t, (addr), sizeof(var), &var) != sizeof(var)) \
    { \
        printf("Failed to write %s to 0x%016llx", #var, (addr)); \
        return 1; \
    } \
} while(0)
